<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pontos de Reciclagem - SustentArte</title>

  <style>
    /* Fundo verde leve */
    body {
      margin: 0;
      padding: 0;
      background: #eaf7e9;
      font-family: Arial, sans-serif;
    }

    /* Área do mapa */
    #map {
      width: 100%;
      height: 100vh;
    }

    /* Botão fixo para gerar rota */
    #btnRota {
      position: absolute;
      top: 20px;
      left: 20px;
      background: #1e9c4e;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      cursor: pointer;
      z-index: 10;
    }
    #btnRota:hover {
      background: #157a3c;
    }
  </style>
</head>

<body>

<button id="btnRota">Traçar rota até Ecoponto</button>
<div id="map"></div>

<script>
  let mapa;
  let userMarker;
  let userLocation;
  let directionsService;
  let directionsRenderer;

  // === Estilo Sustentável Verde ===
  const estiloVerde = [
    { elementType: "geometry", stylers: [{ color: "#e1f3e0" }] },
    { elementType: "labels.text.fill", stylers: [{ color: "#2d6834" }] },
    { elementType: "labels.text.stroke", stylers: [{ color: "#ffffff" }] },
    { featureType: "water", stylers: [{ color: "#9ad1b0" }] },
    { featureType: "poi", stylers: [{ color: "#bfe8c7" }] },
    { featureType: "road", stylers: [{ color: "#d7f3d0" }] },
    { featureType: "road.highway", stylers: [{ color: "#b3dfb3" }] }
  ];

  // === Inicializa o mapa ===
  function initMap() {
    mapa = new google.maps.Map(document.getElementById("map"), {
      zoom: 13,
      center: { lat: -2.5307, lng: -44.3068 }, // São Luís/MA
      styles: estiloVerde,
      disableDefaultUI: false
    });

    directionsService = new google.maps.DirectionsService();
    directionsRenderer = new google.maps.DirectionsRenderer({ map: mapa });

    // Geolocalização do usuário
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((pos) => {
        userLocation = {
          lat: pos.coords.latitude,
          lng: pos.coords.longitude
        };

        // Ícone personalizado do usuário
        userMarker = new google.maps.Marker({
          position: userLocation,
          map: mapa,
          icon: {
            url: "assets/icon/usuario-icon-loc.png",
            scaledSize: new google.maps.Size(60, 60)
          },
          title: "Você está aqui"
        });

        mapa.setCenter(userLocation);
      });
    }

    // === Lista de Ecopontos (adicione mais aqui) ===
    const ecopontos = [
      {
        nome: "Ecoponto Jardim Renascença",
        local: { lat: -2.5045, lng: -44.2872 }
      },
      {
        nome: "Ecoponto Vinhais",
        local: { lat: -2.5133, lng: -44.2801 }
      }
    ];

    // Cria marcadores de ecopontos
    ecopontos.forEach((ponto) => {
      new google.maps.Marker({
        position: ponto.local,
        map: mapa,
        icon: {
          url: "assets/icon/ecoponto-icon-loc.png",
          scaledSize: new google.maps.Size(50, 50)
        },
        title: ponto.nome
      });
    });

    // Botão de rota
    document.getElementById("btnRota").onclick = () => {
      if (!userLocation) {
        alert("Não foi possível obter sua localização.");
        return;
      }

      const destino = ecopontos[0].local; // Rota para o primeiro ecoponto da lista

      directionsService.route(
        {
          origin: userLocation,
          destination: destino,
          travelMode: "DRIVING"
        },
        (result, status) => {
          if (status === "OK") {
            directionsRenderer.setDirections(result);
          } else {
            alert("Erro ao gerar rota: " + status);
          }
        }
      );
    };
  }
</script>

<!-- ====== GOOGLE MAPS API COM SUA KEY ====== -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBCAqJ_ucX_eXXS4D7Ch4fKdMi1nDzgxG0&callback=initMap" async defer></script>

</body>
</html>
